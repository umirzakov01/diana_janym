<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Be My Valentine üíó</title>

  <style>
    :root{
      --pink-1:#fff0f6;
      --pink-2:#ffe3ef;
      --pink-3:#ffd1e6;
      --pink-4:#ffb6d5;
      --hot:#ff4d8d;
      --hot2:#ff2f78;

      --text:#2a1b22;
      --muted:#7a5060;

      --card: rgba(255,255,255,.82);
      --stroke: rgba(255,77,141,.18);
      --shadow: 0 22px 60px rgba(28,10,18,.18);
      --shadow2: 0 14px 30px rgba(255,77,141,.18);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(900px 600px at 20% 20%, var(--pink-1), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, var(--pink-2), transparent 60%),
        radial-gradient(700px 500px at 60% 90%, var(--pink-3), transparent 55%),
        linear-gradient(180deg, #fff, #fff6fa);
      overflow-x:hidden;
    }

    /* –º—è–≥–∫–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏ –Ω–∞ —Ñ–æ–Ω–µ */
    .heart{
      position:fixed;
      bottom:-30px;
      width:18px;height:18px;
      transform: rotate(45deg);
      background: rgba(255,77,141,.50);
      border-radius:4px;
      animation: floatUp linear forwards;
      pointer-events:none;
      z-index:0;
      filter: blur(.1px);
    }
    .heart:before,.heart:after{
      content:"";
      position:absolute;
      width:18px;height:18px;
      background: inherit;
      border-radius:50%;
    }
    .heart:before{ left:-9px; top:0; }
    .heart:after{ left:0; top:-9px; }

    @keyframes floatUp{
      from{ transform: translateY(0) rotate(45deg); opacity:.9; }
      to{ transform: translateY(-110vh) rotate(45deg); opacity:0; }
    }

    .wrap{
      position:relative;
      z-index:1;
      min-height:100svh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 24px 16px 40px;
    }

    .panel{
      width:min(980px, 100%);
      background: var(--card);
      backdrop-filter: blur(12px);
      border: 1px solid var(--stroke);
      border-radius: 28px;
      box-shadow: var(--shadow);
      padding: 22px;
      position:relative;
      overflow:hidden;
    }

    .shine{
      position:absolute;
      inset:-140px;
      pointer-events:none;
      background:
        radial-gradient(circle at 22% 18%, rgba(255,77,141,.18), transparent 45%),
        radial-gradient(circle at 78% 22%, rgba(255,182,213,.20), transparent 42%),
        radial-gradient(circle at 50% 85%, rgba(255,77,141,.10), transparent 40%);
    }

    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 10px;
    }

    .badge{
      font-size:12px;
      font-weight:800;
      letter-spacing:.14em;
      color:#b23563;
      background: rgba(255,77,141,.12);
      border: 1px solid rgba(255,77,141,.18);
      padding: 8px 10px;
      border-radius:999px;
      user-select:none;
      white-space:nowrap;
    }

    h1{
      margin: 8px 0 6px;
      text-align:center;
      font-size: clamp(34px, 5vw, 58px);
      line-height:1.04;
      letter-spacing: .02em;
    }

    .subtitle{
      margin:0 0 16px;
      text-align:center;
      color: var(--muted);
      font-size: 15px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 16px;
      align-items:stretch;
    }
    @media (max-width: 880px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: rgba(255,255,255,.86);
      border: 1px solid rgba(0,0,0,.06);
      border-radius: 24px;
      box-shadow: var(--shadow2);
      padding: 18px;
      position:relative;
      overflow:hidden;
    }

    .penguin{
      font-size: 64px;
      user-select:none;
      filter: drop-shadow(0 10px 18px rgba(255,77,141,.18));
      margin-top: 6px;
    }

    .question{
      font-size: 22px;
      font-weight: 900;
      text-align:center;
      margin: 10px 0 4px;
    }

    .hint{
      text-align:center;
      margin:0;
      color: rgba(122,80,96,.9);
      font-size: 13px;
    }

    .btnRow{
      margin-top: 14px;
      display:flex;
      gap: 12px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
    }

    button{
      border:none;
      cursor:pointer;
      border-radius:999px;
      padding: 14px 22px;
      font-weight: 900;
      letter-spacing:.03em;
      transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
      touch-action: manipulation;
      user-select:none;
      min-width: 140px;
    }

    #yesBtn{
      background: linear-gradient(180deg, var(--hot), var(--hot2));
      color:#fff;
      box-shadow: 0 16px 28px rgba(255,77,141,.35);
      transform: scale(1);
    }
    #yesBtn:hover{ filter: brightness(1.03); }
    #yesBtn:active{ transform: scale(.98); }

    #noBtn{
      background: rgba(255,255,255,.95);
      color:#b23563;
      border: 2px solid rgba(255,77,141,.32);
      box-shadow: 0 14px 26px rgba(255,77,141,.12);
      transform: scale(1);
    }
    #noBtn:hover{ filter: brightness(1.02); }
    #noBtn:active{ transform: scale(.98); }

    .counter{
      margin-top: 12px;
      text-align:center;
      font-size: 13px;
      color:#b23563;
      background: rgba(255,77,141,.10);
      border: 1px dashed rgba(255,77,141,.25);
      border-radius: 16px;
      padding: 8px 10px;
    }

    .sideTitle{
      margin: 0 0 10px;
      font-size: 13px;
      letter-spacing:.12em;
      color:#b23563;
      font-weight: 900;
      text-transform: uppercase;
    }
    .sideText{
      margin:0 0 10px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
    }

    .miniBox{
      background: rgba(255,77,141,.08);
      border: 1px solid rgba(255,77,141,.14);
      border-radius: 18px;
      padding: 10px 12px;
      font-size: 13px;
      color:#5c3344;
    }

    /* MODAL */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      background: rgba(22,10,16,.45);
      z-index:50;
    }
    .modal.show{ display:flex; }

    .modalCard{
      width:min(980px, 100%);
      max-height: min(88svh, 860px);
      overflow:hidden;
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(255,77,141,.18);
      border-radius: 28px;
      box-shadow: 0 28px 80px rgba(0,0,0,.25);
      position:relative;
    }

    .modalHeader{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(0,0,0,.06);
      background: linear-gradient(180deg, rgba(255,240,246,.9), rgba(255,255,255,0));
    }
    .modalHeader h2{
      margin:0;
      font-size: 20px;
      line-height:1.2;
    }
    .modalHeader p{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 14px;
    }

    .closeBtn{
      background: rgba(255,77,141,.12);
      border: 1px solid rgba(255,77,141,.22);
      color:#b23563;
      padding: 10px 14px;
      border-radius: 999px;
      font-weight: 900;
      cursor:pointer;
    }

    .modalBody{
      padding: 14px;
      overflow:auto;
      max-height: calc(min(88svh, 860px) - 64px);
    }

    .letter{
      background:#fff;
      border: 1px solid rgba(0,0,0,.06);
      border-radius: 24px;
      padding: 16px 14px;
      box-shadow: 0 12px 28px rgba(255,77,141,.12);
      position:relative;
      overflow:hidden;
    }

    .ribbon{
      position:absolute;
      top:16px;
      right:-58px;
      transform: rotate(35deg);
      background: linear-gradient(180deg, var(--hot), var(--hot2));
      color:#fff;
      font-weight: 900;
      padding: 10px 78px;
      letter-spacing:.10em;
      font-size: 12px;
      box-shadow: 0 12px 24px rgba(255,77,141,.35);
    }

    .letter h3{
      margin: 0 0 10px;
      font-size: 22px;
    }

    .sentence{
      margin: 0 0 10px;
      color:#4e2c3a;
      line-height: 1.6;
      font-size: 15px;
    }

    .sig{
      margin-top: 12px;
      text-align:right;
      color: var(--muted);
      font-size: 14px;
      font-style: italic;
    }

    .inlinePhoto{
      width:100%;
      border-radius: 18px;
      margin: 10px 0 14px;
      display:block;
      border: 1px solid rgba(0,0,0,.06);
      box-shadow: 0 12px 26px rgba(0,0,0,.10);
      max-height: 420px;
      object-fit: cover;
    }

    /* confetti canvas */
    #confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:60;
      display:none;
    }
    #confetti.show{ display:block; }
  </style>
</head>

<body>
  <canvas id="confetti"></canvas>

  <div class="wrap">
    <div class="panel">
      <div class="shine"></div>

      <div class="top">
        <div class="badge">üíó SOFT PINK MODE</div>
        <div class="badge" id="dateBadge"></div>
      </div>

      <h1>BE MY VALENTINE üíå</h1>
      <p class="subtitle">–ù–∞–∂–º–∏ —á–µ—Å—Ç–Ω–æ‚Ä¶ –Ω–æ –ø–∏–Ω–≥–≤–∏–Ω—ë–Ω–æ–∫ –æ—á–µ–Ω—å –≤–µ—Ä–∏—Ç –≤ YES üêßüíó</p>

      <div class="grid">
        <div class="card" style="text-align:center;">
          <div class="penguin" id="penguin">üêß</div>
          <div class="question" id="questionText">–î–∏–∞–Ω–∞, –±—É–¥–µ—à—å –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π?</div>
          <p class="hint">NO —É–º–µ–Ω—å—à–∏—Ç—Å—è‚Ä¶ YES —Å—Ç–∞–Ω–µ—Ç –±–æ–ª—å—à–µ üò≥</p>

          <div class="btnRow">
            <button id="yesBtn">YES üíñ</button>
            <button id="noBtn">NO üôà</button>
          </div>

          <div class="counter" id="counterText">NO –Ω–∞–∂–∞–ª–∏: 0 —Ä–∞–∑</div>
        </div>

        <div class="card">
          <div class="sideTitle">–§–∞–π–ª—ã</div>
          <p class="sideText">
            –ü–æ–ª–æ–∂–∏ —Ä—è–¥–æ–º <b>music.mp3</b> –∏ –ø–∞–ø–∫—É <b>photos</b> —Å —Ñ–æ—Ç–æ <b>1.jpg‚Äì9.jpg</b>.
            –ú—É–∑—ã–∫–∞ –≤–∫–ª—é—á–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è YES (—Ç–∞–∫ –¥–µ–ª–∞—é—Ç –≤—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã).
          </p>
          <div class="miniBox">
            üí° –ï—Å–ª–∏ —Ñ–æ—Ç–æ —É —Ç–µ–±—è .png ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è–π –≤ –∫–æ–¥–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ .png (—è –ø–æ–¥–ø–∏—Å–∞–ª –≥–¥–µ).
          </div>
          <div style="height:10px"></div>
          <div class="sideTitle">–ù–µ–∂–Ω–æ—Å—Ç—å</div>
          <p class="sideText">
            –í—Å—ë —Å–¥–µ–ª–∞–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ: –º—è–≥–∫–∏–µ —Ç–µ–Ω–∏, –ø–∞—Å—Ç–µ–ª—å–Ω—ã–π —Ä–æ–∑–æ–≤—ã–π, –±–µ–∑ ‚Äú–∫—Ä–∏—á–∞—â–∏—Ö‚Äù —Ü–≤–µ—Ç–æ–≤ ‚ú®
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Music -->
  <audio id="loveMusic" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <!-- Modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true">
    <div class="modalCard">
      <div class="modalHeader">
        <div>
          <h2>–ü–∏—Å—å–º–æ –¥–ª—è –î–∏–∞–Ω—ã üíå</h2>
          <p>–¢—ã –Ω–∞–∂–∞–ª–∞ YES ‚Äî –∏ –ø–∏–Ω–≥–≤–∏–Ω—ë–Ω–æ–∫ –ø—Ä–∞–∑–¥–Ω—É–µ—Ç üêßüíó</p>
        </div>
        <button class="closeBtn" id="closeBtn">–ó–∞–∫—Ä—ã—Ç—å ‚úñ</button>
      </div>

      <div class="modalBody">
        <div class="letter">
          <div class="ribbon">LOVE</div>

          <div id="letterContent"></div>

          <div class="sig">‚Äî –æ—Ç: <span id="fromName">–¢–í–û–Å –ò–ú–Ø</span></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    const fromName = "–¢–í–û–Å –ò–ú–Ø"; // –≤–ø–∏—à–∏ —Å–≤–æ—ë –∏–º—è

    // 9 —Ñ–æ—Ç–æ (–µ—Å–ª–∏ —É —Ç–µ–±—è png, –∑–∞–º–µ–Ω–∏ .jpg –Ω–∞ .png)
    const photos = [
      "photos/1.jpg",
      "photos/2.jpg",
      "photos/3.jpg",
      "photos/4.jpg",
      "photos/5.jpg",
      "photos/6.jpg",
      "photos/7.jpg",
      "photos/8.jpg",
      "photos/9.jpg",
    ];

    // –¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞ (—Ç–æ, —á—Ç–æ –º—ã —É–∂–µ –ø–∏—Å–∞–ª–∏ –≤ –¥–∏–∞–ª–æ–≥–µ ‚Äî –Ω–µ–∂–Ω–æ –∏ –ø—Ä–æ—Å—Ç–æ)
    // –ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–π —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç.
    const sentences = [
      "–î–∏–∞–Ω–∞,",
      "—É –º–µ–Ω—è –∫ —Ç–µ–±–µ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å‚Ä¶",
      "–Ø –¥–∞–≤–Ω–æ —Ö–æ—Ç–µ–ª(–∞) —Å–ø—Ä–æ—Å–∏—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–µ–±—è.",
      "–ë—É–¥–µ—à—å –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π?",
      "–û–±–µ—â–∞—é –±–µ—Ä–µ—á—å, —Ä–∞–¥–æ–≤–∞—Ç—å –∏ –¥–µ–ª–∞—Ç—å —Ç–≤–æ–∏ –¥–Ω–∏ —á—É—Ç—å-—á—É—Ç—å —Ç–µ–ø–ª–µ–µ.",
      "–¢—ã –º–Ω–µ –ø—Ä–∞–≤–¥–∞ –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–∞.",
      "–ï—Å–ª–∏ —Ç—ã —Å–∫–∞–∂–µ—à—å ¬´–¥–∞¬ª, —è –±—É–¥—É —Å–∞–º—ã–º —Å—á–∞—Å—Ç–ª–∏–≤—ã–º –ø–∏–Ω–≥–≤–∏–Ω—ë–Ω–∫–æ–º –Ω–∞ —Å–≤–µ—Ç–µ üêßüíó"
    ];
    // =====================

    const yesBtn = document.getElementById("yesBtn");
    const noBtn  = document.getElementById("noBtn");
    const counterText = document.getElementById("counterText");
    const questionText = document.getElementById("questionText");
    const penguin = document.getElementById("penguin");

    const modal = document.getElementById("modal");
    const closeBtn = document.getElementById("closeBtn");
    const loveMusic = document.getElementById("loveMusic");

    const fromNameEl = document.getElementById("fromName");
    const letterContent = document.getElementById("letterContent");
    fromNameEl.textContent = fromName;

    // date badge
    const dateBadge = document.getElementById("dateBadge");
    const now = new Date();
    const dd = String(now.getDate()).padStart(2,'0');
    const mm = String(now.getMonth()+1).padStart(2,'0');
    const yyyy = now.getFullYear();
    dateBadge.textContent = `${dd}.${mm}.${yyyy}`;

    // build letter: after each sentence -> next photo (1-9)
    function buildLetter(){
      letterContent.innerHTML = "";

      // –í—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è + —Ñ–æ—Ç–æ –ø–æ –ø–æ—Ä—è–¥–∫—É
      let photoIndex = 0;

      sentences.forEach((s, idx) => {
        const p = document.createElement("p");
        p.className = "sentence";
        p.textContent = s;
        letterContent.appendChild(p);

        // –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ‚Äî —Ñ–æ—Ç–æ, –ø–æ–∫–∞ –µ—Å—Ç—å 1..9
        if (photoIndex < photos.length) {
          const img = document.createElement("img");
          img.className = "inlinePhoto";
          img.src = photos[photoIndex];
          img.alt = `photo ${photoIndex+1}`;
          letterContent.appendChild(img);
          photoIndex++;
        }
      });

      // –µ—Å–ª–∏ —Ñ–æ—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –±–æ–ª—å—à–µ, —á–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π ‚Äî –¥–æ–∫–∏–¥—ã–≤–∞–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è
      while (photoIndex < photos.length) {
        const img = document.createElement("img");
        img.className = "inlinePhoto";
        img.src = photos[photoIndex];
        img.alt = `photo ${photoIndex+1}`;
        letterContent.appendChild(img);
        photoIndex++;
      }
    }
    buildLetter();

    // hearts
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      const size = 10 + Math.random()*18;
      h.style.width = size + "px";
      h.style.height = size + "px";
      h.style.left = (Math.random()*100) + "vw";
      h.style.animationDuration = (3.4 + Math.random()*3.6) + "s";
      h.style.opacity = (0.35 + Math.random()*0.55).toFixed(2);
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 8000);
    }
    setInterval(()=>{ if(Math.random()<0.35) spawnHeart(); }, 700);

    // YES/NO scaling
    let noCount = 0;
    let yesScale = 1;
    let noScale  = 1;

    const noMsgs = [
      "—Ç–æ—á–Ω–æ? ü•∫",
      "–ø–∏–Ω–≥–≤–∏–Ω—ë–Ω–æ–∫ —Ä–∞—Å—Å—Ç—Ä–æ–∏–ª—Å—è üòø",
      "–Ω—É –ø–æ–∂–∞–ª—É–π—Å—Ç–∞‚Ä¶ üíó",
      "YES —Ç–∞–∫–∞—è –∫—Ä–∞—Å–∏–≤–∞—è‚Ä¶ üôà",
      "—è –æ—á–µ–Ω—å –ø—Ä–æ—à—É üò≥",
      "–ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å‚Ä¶ ü•∫üíû"
    ];

    noBtn.addEventListener("click", () => {
      noCount++;

      // YES —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
      yesScale = Math.min(yesScale + 0.20, 3.8);
      yesBtn.style.transform = `scale(${yesScale})`;

      // NO —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
      noScale = Math.max(noScale - 0.10, 0.45);
      noBtn.style.transform = `scale(${noScale})`;

      counterText.textContent = `NO –Ω–∞–∂–∞–ª–∏: ${noCount} —Ä–∞–∑`;

      const msg = noMsgs[Math.min(noCount-1, noMsgs.length-1)];
      questionText.textContent = `–î–∏–∞–Ω–∞, –±—É–¥–µ—à—å –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π? (${msg})`;

      // –º–∏–ª—ã–π –ø–∏–Ω–≥–≤–∏–Ω-—Ä–µ–∞–∫—Ü–∏—è
      if (noCount === 1) penguin.textContent = "üêß";
      if (noCount === 3) penguin.textContent = "üêßüíó";
      if (noCount === 5) penguin.textContent = "üêßü•∫";
      if (noCount >= 7) penguin.textContent = "üêßüíû";

      spawnHeart();
      if (noCount % 2 === 0) spawnHeart();
    });

    // Modal open/close
    function openModal(){
      modal.classList.add("show");
      document.body.style.overflow = "hidden";
    }
    function closeModal(){
      modal.classList.remove("show");
      document.body.style.overflow = "";
    }

    closeBtn.addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => {
      if (e.target === modal) closeModal();
    });
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && modal.classList.contains("show")) closeModal();
    });

    // Confetti
    const confettiCanvas = document.getElementById("confetti");
    const ctx = confettiCanvas.getContext("2d");

    function resizeCanvas(){
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    let confettiPieces = [];
    let confettiRunning = false;

    function startConfetti(durationMs = 2200){
      confettiCanvas.classList.add("show");
      confettiRunning = true;
      confettiPieces = [];

      const w = confettiCanvas.width;
      const h = confettiCanvas.height;

      const count = 180;
      for(let i=0;i<count;i++){
        confettiPieces.push({
          x: Math.random()*w,
          y: -20 - Math.random()*h*0.2,
          r: 4 + Math.random()*6,
          vx: -2 + Math.random()*4,
          vy: 2.5 + Math.random()*4.5,
          rot: Math.random()*Math.PI,
          vr: -0.12 + Math.random()*0.24,
          alpha: 0.9
        });
      }

      const start = performance.now();
      function tick(t){
        if(!confettiRunning) return;
        const elapsed = t - start;

        ctx.clearRect(0,0,w,h);
        confettiPieces.forEach(p=>{
          p.x += p.vx;
          p.y += p.vy;
          p.rot += p.vr;
          p.vy += 0.02; // –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è
          p.alpha = Math.max(0, p.alpha - 0.002);

          ctx.save();
          ctx.globalAlpha = p.alpha;

          // –Ω–µ–∂–Ω—ã–µ —Ä–æ–∑–æ–≤—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏ (–±–µ–∑ –∑–∞–¥–∞–≤–∞–Ω–∏—è ‚Äú–∂—ë—Å—Ç–∫–∏—Ö‚Äù —Ü–≤–µ—Ç–æ–≤ –≤ CSS, –Ω–æ —Ç—É—Ç —Ä–∏—Å—É–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏)
          const shade = 200 + Math.floor(Math.random()*55);
          ctx.fillStyle = `rgba(255, ${shade}, ${shade}, ${p.alpha})`;

          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillRect(-p.r, -p.r/2, p.r*2.1, p.r);
          ctx.restore();
        });

        confettiPieces = confettiPieces.filter(p => p.y < h + 30 && p.alpha > 0.05);

        if(elapsed < durationMs && confettiPieces.length){
          requestAnimationFrame(tick);
        } else {
          confettiRunning = false;
          ctx.clearRect(0,0,w,h);
          confettiCanvas.classList.remove("show");
        }
      }
      requestAnimationFrame(tick);
    }

    // YES click: music + confetti + modal
    yesBtn.addEventListener("click", () => {
      // –º—É–∑—ã–∫–∞ (–ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ)
      loveMusic.play().catch(()=>{});

      // –º–∞–ª–µ–Ω—å–∫–∏–π –¥–æ–∂–¥–∏–∫ —Å–µ—Ä–¥–µ—á–µ–∫
      for(let i=0;i<14;i++) setTimeout(spawnHeart, i*45);

      // –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
      startConfetti(2400);

      openModal();
    });
  </script>
</body>
</html>





